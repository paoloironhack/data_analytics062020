SQL Select

##Challenge 1

SELECT 
	a.au_id 'AUTHOR ID',    
    a.au_lname 'LAST NAME',
    a.au_fname 'FIRST NAME',
    t.title 'TITLE',
    p.pub_name 'PUBLISHER'
FROM
	titleauthor ta
    INNER JOIN authors a
    ON ta.au_id = a.au_id
    INNER JOIN titles t
    ON ta.title_id = t.title_id
    INNER JOIN publishers p
    ON t.pub_id = p.pub_id
ORDER BY 1 ASC


##challenge 2
SELECT 
	a.au_id 'AUTHOR ID',    
    a.au_lname 'LAST NAME',
    a.au_fname 'FIRST NAME',
    p.pub_name 'PUBLISHER',
    COUNT(t.title) 'TITLE'
FROM
	titleauthor ta
    INNER JOIN authors a
    ON ta.au_id = a.au_id
    INNER JOIN titles t
    ON ta.title_id = t.title_id
    INNER JOIN publishers p
    ON t.pub_id = p.pub_id
GROUP BY
	a.au_id,    
    a.au_lname,
    a.au_fname,
    p.pub_name
ORDER BY 5 DESC, 1 DESC

##challenge 3
SELECT
	a.au_id 'AUTHOR ID',    
    a.au_lname 'LAST NAME',
    a.au_fname 'FIRST NAME',
    SUM(t.ytd_sales) 'TOTAL'
FROM
	titleauthor ta
    INNER JOIN authors a
    ON ta.au_id = a.au_id
    INNER JOIN titles t
    ON ta.title_id = t.title_id
GROUP BY
	a.au_id,    
    a.au_lname,
    a.au_fname
ORDER BY 4 DESC 
LIMIT 3

##Challenge 4
SELECT
	a.au_id 'AUTHOR ID',    
    a.au_lname 'LAST NAME',
    a.au_fname 'FIRST NAME',
    CASE WHEN t.ytd_sales is null THEN 0 ELSE SUM(t.ytd_sales) END 'TOTAL'
FROM
	titleauthor ta
    INNER JOIN authors a
    ON ta.au_id = a.au_id
    INNER JOIN titles t
    ON ta.title_id = t.title_id
GROUP BY
	a.au_id,    
    a.au_lname,
    a.au_fname
ORDER BY 4 DESC 